{
  "meta": {
    "start_time": "2025-11-07 14:29:10",
    "base": "http://localhost:3000",
    "api": "http://localhost:3000/api/v1/product"
  },
  "tests": [
    {
      "name": "RBAC - Admin create product",
      "ok": true,
      "status_code": 201,
      "summary": "Admin should be able to create product (multipart/form-data)",
      "details": "{\"success\":true,\"message\":\"Product created successfully\",\"products\":{\"name\":\"rbac_prod_1762496955\",\"slug\":\"rbac_prod_1762496955\",\"description\":\"products created for security testing\",\"price\":10,\"category\":\"66db427fdb0119d9234b27ee\",\"quantity\":100,\"photo\":{\"data\":{\"type\":\"Buffer\",\"data\":[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1]},\"contentType\":\"image/png\"},\"shipping\":false,\"_id\":\"690d91bdc917e88e72a6e87c\",\"createdAt\":\"2025-11-07T06:29:17.772Z\",\"updatedAt\":\"2025-11-07T06:29:17.772Z\",\"__v\":0}}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:29:18"
    },
    {
      "name": "RBAC - User cannot create product",
      "ok": true,
      "status_code": 401,
      "summary": "User should not be able to create product (multipart/form-data)",
      "details": "{\"success\":false,\"message\":\"Unauthorized Access\"}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:29:20"
    },
    {
      "name": "RBAC - No Token cannot create product",
      "ok": true,
      "status_code": 401,
      "summary": "No Token should not be able to create product (multipart/form-data)",
      "details": "{\"success\":false,\"error\":{\"name\":\"JsonWebTokenError\",\"message\":\"jwt must be provided\"},\"message\":\"Error in sign in verification\"}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:29:22"
    },
    {
      "name": "RBAC - Admin can update product",
      "ok": true,
      "status_code": 201,
      "summary": "Admin should be able to update product (multipart/form-data)",
      "details": "{\"success\":true,\"message\":\"Product updated successfully\",\"products\":{\"photo\":{\"data\":{\"type\":\"Buffer\",\"data\":[]},\"contentType\":\"image/png\"},\"_id\":\"690d91bdc917e88e72a6e87c\",\"name\":\"rbac_prod_1762496955\",\"slug\":\"rbac_prod_1762496955\",\"description\":\"products created for security testing\",\"price\":10,\"category\":\"66db427fdb0119d9234b27ee\",\"quantity\":100,\"shipping\":false,\"createdAt\":\"2025-11-07T06:29:17.772Z\",\"updatedAt\":\"2025-11-07T06:29:24.928Z\",\"__v\":0}}",
      "endpoint": "/update-product",
      "timestamp": "2025-11-07 14:29:25"
    },
    {
      "name": "RBAC - User cannot update product",
      "ok": true,
      "status_code": 401,
      "summary": "User should not be able to update product (multipart/form-data)",
      "details": "{\"success\":false,\"message\":\"Unauthorized Access\"}",
      "endpoint": "/update-product",
      "timestamp": "2025-11-07 14:29:27"
    },
    {
      "name": "RBAC - No Token cannot update product",
      "ok": true,
      "status_code": 401,
      "summary": "No Token should not be able to update product (multipart/form-data)",
      "details": "{\"success\":false,\"error\":{\"name\":\"JsonWebTokenError\",\"message\":\"jwt must be provided\"},\"message\":\"Error in sign in verification\"}",
      "endpoint": "/update-product",
      "timestamp": "2025-11-07 14:29:29"
    },
    {
      "name": "RBAC - Admin can delete product",
      "ok": true,
      "status_code": 200,
      "summary": "Admin should be able to delete product",
      "details": "{\"success\":true,\"message\":\"Product deleted successfully\"}",
      "endpoint": "/delete-product",
      "timestamp": "2025-11-07 14:29:32"
    },
    {
      "name": "RBAC - User cannot delete product",
      "ok": true,
      "status_code": 401,
      "summary": "User should not be able to delete product",
      "details": "{\"success\":false,\"message\":\"Unauthorized Access\"}",
      "endpoint": "/delete-product",
      "timestamp": "2025-11-07 14:29:34"
    },
    {
      "name": "RBAC - No Token cannot delete product",
      "ok": true,
      "status_code": 401,
      "summary": "No Token should not be able to delete product",
      "details": "{\"success\":false,\"error\":{\"name\":\"JsonWebTokenError\",\"message\":\"jwt must be provided\"},\"message\":\"Error in sign in verification\"}",
      "endpoint": "/delete-product",
      "timestamp": "2025-11-07 14:29:36"
    },
    {
      "name": "Mass Assignment Vulnerability- create product",
      "ok": true,
      "status_code": 403,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"Extra Fields are not allowed\"}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:29:41"
    },
    {
      "name": "Mass Assignment - update",
      "ok": true,
      "status_code": 403,
      "summary": null,
      "details": "{\"message\":\"Extra Fields are not allowed\"}",
      "endpoint": "/update-product/690d91d7c917e88e72a6e88a",
      "timestamp": "2025-11-07 14:29:46"
    },
    {
      "name": "Image MIME rejected",
      "ok": true,
      "status_code": 403,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"Photo Content Type not Valid\"}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:29:50"
    },
    {
      "name": "Image Size limit enforced",
      "ok": true,
      "status_code": 413,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"Photo is required and should be less than 1MB\"}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:29:53"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/get-product/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <script>alert(1)</script>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/get-product/",
      "timestamp": "2025-11-07 14:29:55"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/product-photo/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <script>alert(1)</script>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/product-photo/",
      "timestamp": "2025-11-07 14:29:57"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/search/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <script>alert(1)</script>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/search/",
      "timestamp": "2025-11-07 14:29:59"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/related-product/",
      "ok": true,
      "status_code": 400,
      "summary": "Reflected XSS - <script>alert(1)</script>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/related-product/",
      "timestamp": "2025-11-07 14:30:01"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/product-category/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <script>alert(1)</script>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/product-category/",
      "timestamp": "2025-11-07 14:30:03"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/product-category-count/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <script>alert(1)</script>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/product-category-count/",
      "timestamp": "2025-11-07 14:30:05"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/get-product/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <svg/onload=alert(1)>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/get-product/",
      "timestamp": "2025-11-07 14:30:07"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/product-photo/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <svg/onload=alert(1)>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/product-photo/",
      "timestamp": "2025-11-07 14:30:09"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/search/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <svg/onload=alert(1)>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/search/",
      "timestamp": "2025-11-07 14:30:11"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/related-product/",
      "ok": true,
      "status_code": 400,
      "summary": "Reflected XSS - <svg/onload=alert(1)>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/related-product/",
      "timestamp": "2025-11-07 14:30:13"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/product-category/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <svg/onload=alert(1)>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/product-category/",
      "timestamp": "2025-11-07 14:30:15"
    },
    {
      "name": "Reflected XSS - http://localhost:3000/api/v1/product/product-category-count/",
      "ok": true,
      "status_code": 404,
      "summary": "Reflected XSS - <svg/onload=alert(1)>",
      "details": null,
      "endpoint": "http://localhost:3000/api/v1/product/product-category-count/",
      "timestamp": "2025-11-07 14:30:17"
    },
    {
      "name": "Product Filters NoSQL op - {'checked': [{'$gt': ''}]}",
      "ok": true,
      "status_code": 400,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"Invalid checked element (objects not allowed)\"}",
      "endpoint": "/product-filters",
      "timestamp": "2025-11-07 14:30:19"
    },
    {
      "name": "Product Filters NoSQL op - {'checked': ['$ne:']}",
      "ok": true,
      "status_code": 400,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"Invalid checked element (objects not allowed)\"}",
      "endpoint": "/product-filters",
      "timestamp": "2025-11-07 14:30:22"
    },
    {
      "name": "Product Filters NoSQL op - {'checked': {'$gt': ''}}",
      "ok": true,
      "status_code": 400,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"checked must be an array\"}",
      "endpoint": "/product-filters",
      "timestamp": "2025-11-07 14:30:24"
    },
    {
      "name": "Product Filters NoSQL op - {'radio': [{'$regex': '.*'}, 1000]}",
      "ok": true,
      "status_code": 400,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"price range must be numbers only\"}",
      "endpoint": "/product-filters",
      "timestamp": "2025-11-07 14:30:26"
    },
    {
      "name": "Product Filters NoSQL op - {'radio': {'$regex': '.*'}}",
      "ok": true,
      "status_code": 400,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"price range must be provided\"}",
      "endpoint": "/product-filters",
      "timestamp": "2025-11-07 14:30:28"
    },
    {
      "name": "Product Filters NoSQL op - {'radio': '$regex : .*'}",
      "ok": true,
      "status_code": 400,
      "summary": null,
      "details": "{\"success\":false,\"message\":\"price range must be provided\"}",
      "endpoint": "/product-filters",
      "timestamp": "2025-11-07 14:30:30"
    },
    {
      "name": "Search ReDoS / very long input",
      "ok": true,
      "status_code": 400,
      "summary": null,
      "details": "len=2000",
      "endpoint": "/search/:keyword",
      "timestamp": "2025-11-07 14:30:32"
    },
    {
      "name": "JWT Corruption (create-product)",
      "ok": true,
      "status_code": 401,
      "summary": null,
      "details": "{\"success\":false,\"error\":{\"name\":\"JsonWebTokenError\",\"message\":\"invalid signature\"},\"message\":\"Error in sign in verification\"}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:30:34"
    },
    {
      "name": "Stored XSS - create response should not contain raw payload",
      "ok": true,
      "status_code": 201,
      "summary": "Creation allowed; response must not echo raw payload",
      "details": "{\"success\":true,\"message\":\"Product created successfully\",\"products\":{\"name\":\"alert('xss')1762497034\",\"slug\":\"alert('xss')1762497034\",\"description\":\"alert('xss')1762497034\",\"price\":1,\"category\":\"66db427fdb0119d9234b27ee\",\"quantity\":1,\"photo\":{\"data\":{\"type\":\"Buffer\",\"data\":[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1]},\"contentType\":\"image/png\"},\"shipping\":false,\"_id\":\"690d920cc917e88e72a6e892\",\"createdAt\":\"2025-11-07T06:30:36.872Z\",\"updatedAt\":\"2025-11-07T06:30:36.872Z\",\"__v\":0}}",
      "endpoint": "/create-product",
      "timestamp": "2025-11-07 14:30:37"
    },
    {
      "name": "Stored XSS - update response should not contain raw payload",
      "ok": true,
      "status_code": 201,
      "summary": "Update allowed; response must not echo raw payload",
      "details": "{\"success\":true,\"message\":\"Product updated successfully\",\"products\":{\"photo\":{\"data\":{\"type\":\"Buffer\",\"data\":[]},\"contentType\":\"image/png\"},\"_id\":\"690d9211c917e88e72a6e897\",\"name\":\"alert('xss')1762497042\",\"slug\":\"alert('xss')1762497042\",\"description\":\"alert('xss')1762497042\",\"price\":1,\"category\":\"66db427fdb0119d9234b27ee\",\"quantity\":1,\"shipping\":false,\"createdAt\":\"2025-11-07T06:30:41.962Z\",\"updatedAt\":\"2025-11-07T06:30:44.500Z\",\"__v\":0}}",
      "endpoint": "/update-product/690d9211c917e88e72a6e897",
      "timestamp": "2025-11-07 14:30:47"
    },
    {
      "name": "Stored XSS - GET product list should not contain raw payload",
      "ok": true,
      "status_code": 200,
      "summary": "Public list should not reflect raw XSS payload",
      "details": "{\"success\":true,\"countTotal\":6,\"message\":\"All products \",\"products\":[{\"_id\":\"67a2171ea6d9e00ef2ac0229\",\"name\":\"The Law of Contract in Singapore\",\"slug\":\"the-law-of-contract-in-singapore\",\"description\":\"A bestselling book in Singapore\",\"price\":54.99,\"category\":{\"_id\":\"66db427fdb0119d9234b27ef\",\"name\":\"Books\",\"slug\":\"books\"},\"quantity\":0,\"shipping\":true,\"createdAt\":\"2024-09-06T17:57:19.992Z\",\"updatedAt\":\"2025-10-21T03:10:08.257Z\",\"__v\":0},{\"_id\":\"66db427fdb0119d9234b27f9\",\"name\":\"Novel\",\"slug\":\"no",
      "endpoint": "/get-product",
      "timestamp": "2025-11-07 14:30:50"
    },
    {
      "name": "Rate Limit - Get Product. Expect at least one Status 429",
      "ok": true,
      "status_code": null,
      "summary": "[200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 200, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429, 429]",
      "details": null,
      "endpoint": "/get-product",
      "timestamp": "2025-11-07 14:30:55"
    },
    {
      "name": "CORS - Malicious origin denied",
      "ok": true,
      "status_code": 200,
      "summary": "ACAO=http://localhost:3000",
      "details": null,
      "endpoint": "/get-product",
      "timestamp": "2025-11-07 14:30:57"
    }
  ]
}